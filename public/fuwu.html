<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>到位APP - 高品质上门服务直约平台 , 家政服务 , 上门按摩 , 上门维修 , 搬家 , 安心到家！</title>
  <link rel="stylesheet" href="./css/reset.css">
  <link rel="stylesheet" href="./css/head.css">
  <link rel="stylesheet" href="./css/fuwu.css">
  <link rel="stylesheet" href="./css/foot.css">

  <script type="text/javascript" src="./js/jquery-1.10.1.js"></script>
  <script type="text/javascript" src="./js/template-web.js"></script>
  <script src="https://cdn.bootcss.com/moment.js/2.21.0/moment.min.js"></script>
</head>
<body>
<!--头部部分-->
<header>
  <div class="head-conent">
    <div class="head-logo">
      <a href="javascript:;">
        <img src="./images/logo.png">
      </a>
    </div>
    <div class="address">
      <a href="javascrip:;">
        <img src="./images/citypoint.png">
        <span>北京</span>
        <span>切换城市</span>
      </a>
    </div>
    <div class="nav-brand">
      <ul class="head-list">
        <li ><a href="http://localhost:3000/index.html">首页</a></li>
        <li><a href="javascript:;">到位APP</a></li>
        <li class="on"><a href="javascript:;">服务商</a></li>
        <li><a href="javascript:;">商家入驻</a></li>
        <li><a href="javascript:;">风物APP</a></li>
        <li><a href="javascript:;">关于我们</a></li>
        <li><a class="shanglu" href="javascript:;">商家登录</a></li>
      </ul>
    </div>
  </div>
</header>
<!--中间主体部分-->
<div class="htit">
 <div class="htit-center">
   <div class="htit-left">
  <b>云家政</b>
   <span>营业时间：<em class="em1">09:00-18:00</em> </span>
   <span>最近可预约时间：<em class="em2">03月21日 14:00</em></span>
 </div>
   <div class="htit-right">
     <div>
       <i>45658</i>成功接单
       <em>|</em>
     </div>
     <div>
       <i>94%</i>接单率
       <em>|</em>
     </div>
     <div>
       <i>86%%</i>好评率
       <em>|</em>
     </div>
   </div>
 </div>
</div>
<!--下面导航区域-->
<div class="nav">
<div class="navlist">
  <span>服务项目</span>
  <span>商家简介</span>
  <span>用户评论</span>
</div>
</div>
<!--服务项目-->
<div  class="fuwucenter">
  <div class="fuwuleft">
  <h3> <span>服务项目</span></h3>
  <div class="boxtab">
    <div class="iteminfo">
      <!--模块渲染tem1-->
    </div>

    <h3 class="paihang">
    <!--模块渲染tem2-->
    </h3>

    <!--评论列表-->
    <div class="comment-wrap">
    <div class="commentDiv">
      <!--  <div class="conmentss"><img src="./images/avatar.jpg" >
          <ul>
            <li>闫晓旭</li>
            <li>
             <span class="noColor">
               <img src="./images/red_star.png" >
               <img src="./images/red_star.png" >
               <img src="./images/red_star.png" >
               <img src="./images/red_star.png" >
               <img src="./images/red_star.png" >
               <em>2018-03-20</em>
             </span>
            </li>
            <li class="commentdetail">准时到达，服务专业，态度热情</li>
            <li class="commentposition"><img src="./images/position.jpg">北京  朝阳区</li>
          </ul>
        </div>-->

    </div>
      <div class="fenye2">
        <a href="javascript:;" class="pageup "> < 上一页</a>
        <div class="showPage">
          <a href="javascript:;" class="num acv">1</a>
          <a href="javascript:;" class="num">2</a>
          <a href="javascript:;" class="num">3</a>
          <a href="javascript:;" class="num">4</a>
          <a href="javascript:;" class="num">5</a>
          <a href="javascript:;" class="num">6</a>
          <a href="javascript:;" class="num">7</a>
          <a href="javascript:;" class="num">8</a>
          <a href="javascript:;" class="num">9</a>
          ...
        </div>
        <a href="javascript:;" class="pagedown on">下一页 ></a>
      </div>
    </div>
  </div>
  </div>
  <div class="comment-right">
    <div class="c1"><img src="./images/serve/daoweiApp1.png"> </div>
    <div class="c2"><img src="./images/serve/daowayApp.png"></div>
  </div>
</div>
<!--底部区域-->
<footer>
  <div class="baozhang-wrap">
    <div class="baozhang">到位 <span class="servers">服务</span>保障 </div>
    <p>到位平台担保交易安全，交易未成功100%退款</p>
    <div class="anquan">
      <span> <img src="./images/anquan.jpg" >优选服务</span>
      <span> <img src="./images/anquan.jpg" >全程保障</span>
      <span> <img src="./images/anquan.jpg" >安全无忧</span>
    </div>
  </div>
  <!--热门城市-->
  <div class="city">
    <span class="remen">热门城市</span>
    <div class="city_list">
      <div class="row">
        <a href="#">北京</a>
        <a href="#">上海</a>
        <a href="#">广州</a>
        <a href="#">深圳</a>
        <a href="#">成都</a>
        <a href="#">天津</a>
        <a href="#">南京</a>
        <a href="#">重庆</a>
        <a href="#">杭州</a>
        <a href="#">苏州</a>
        <a href="#">武汉</a>
      </div>
      <div class="row">
        <a href="#">长沙</a>
        <a href="#">济南</a>
        <a href="#">郑州</a>
        <a href="#">西安</a>
        <a href="#">沈阳</a>
        <a href="#">福州</a>
        <a href="#">厦门</a>
        <a href="#">南昌</a>
        <a href="#">合肥</a>
        <a href="#">宁波</a>
        <a href="#">无锡</a>
      </div>
      <div class="row row3">
        <a href="#">青岛</a>
        <a href="#">大连</a>
        <a href="#">东莞</a>
        <a href="#">佛山</a>
        <a href="#">石家庄</a>
        <a href="#">哈尔滨</a>
        <a href="#">太原</a>
        <a href="#">昆明</a>
        <a href="#">贵阳</a>
        <a href="#">南宁</a>
        <a href="#">温州</a>
      </div>
    </div>
  </div>
  <!--最下方列表-->
  <p class="renzheng">©2015 版权所有 到位 daoway.com 京ICP备15001471号-1 北京邻家科技有限公司</p>
</footer>
<script type="text/javascript">
  $(function () {
    var page = 1;
    $.get('http://localhost:3000/getServiceItem',function (data) {
    $('.iteminfo').append(template('tem1',{data:data}))

    })
    $.get('http://localhost:3000/getComments1',function (data) {
      $('.paihang').append(template('tem2',{data:data}))
    })
    $.get('http://localhost:3000/getComments',function (data) {
       //过滤时间
      template.defaults.imports.dateFormat = function (data,format) {
        return moment(data).format(format);
      }

      let newdata = getStar(data)
      console.log(newdata)
      $('.commentDiv').prepend(template('tem3',{data:newdata}))
    })
       //点击每一页
     $('.showPage>a').click(function () {
       let index = $(this).index()
       page = index+1
       $('.showPage>a').removeClass('acv')
       $(this).addClass('acv')
      getPage(page)
       $.get('http://localhost:3000/getComments?page=' +page,function (data) {
        let newdata = getStar(data)
//        var  data = data.comments
        $('.commentDiv').html(template('tem3',{data:newdata}))
      })
     })
         //点击上一页
     $('.fenye2>.pageup').click(function () {
       page--
       getPage(page)

       var index = page-1


        $('.showPage>a').removeClass('acv')
        $($('.showPage>a').get(index)).addClass('acv')
       $.get('http://localhost:3000/getComments?page=' +page,function (data) {
         let newdata = getStar(data)
//        var  data = data.comments
         $('.commentDiv').html(template('tem3',{data:newdata}))
       })
     })
         //点击下一页
    $('.fenye2>.pagedown').click(function () {
      page++
      getPage(page)

      var index =page-1


      $('.showPage >a').removeClass('acv')
      $($('.showPage >a').get(index)).addClass('acv')
      $.get('http://localhost:3000/getComments?page=' +page,function (data) {
        let newdata = getStar(data)
        $('.commentDiv').html(template('tem3',{data:newdata}))
      })
    })
     //筛选星星
    function getStar(data) {
      return data.comments.map(function (value,index) {
        let count = value.star
        let starts = []
        for (var i = 0; i < 5; i++) {
          if(count>0){
            count--
            starts.push('./images/red_star.png')
          }else{
            starts.push('./images/gray_star.png')
          }
        }
        value.starts = starts
        return value
      })
    }
     //筛选第一页和最后一页
    function getPage(p) {
      if(p>=9){
        $('.fenye2>.pageup').addClass('on')
        $('.fenye2>.pagedown').removeClass('on')
        page = 9
      }else if(p<=1){
        $('.fenye2>.pageup').removeClass('on')
        $('.fenye2>.pagedown').addClass('on')
        page =1
      }
    }

  })
</script>
<!--公司简介-->
<script id="tem1" type="text/html">
  <div>
    <a href="http://localhost:3000/xiangqing.html">
      <div class="fuwuimg">
        <img src="{{data.item.imgUrl}}" alt="">
        <span class="spm">
        <i>{{data.item.name}}</i>
        <i>{{data.item.desc}}</i>
        <i class="pri">{{data.item.price}} <em>元/小时</em></i>
        <b>原价 <em>{{data.item.oldPrice}}</em></b>
      </span>

        <span class="spy">已售{{data.item.orderCount}}</span>
      </div>
    </a>
    <div class="info">
      <div class="hh3" ><span>商家简介</span></div>
    </div>
    <div class="company">
    {{data.item.company}}
      <img src="./images/renzheng.jpg" alt="">
    </div>
    <p class="pp">
  {{data.item.profile}}
    </p>
  </div>
</script>
<!--用户评论-->
<script id="tem2" type="text/html">
  <span class="s1">用户评论</span>
  <span class="s2">({{data.comments.length}}条评论)</span>
</script>
<!--评论详情-->
<script id="tem3" type="text/html">
  {{each data}}
  <div class="conmentss">
    <img src="{{$value.iconUrl}}" >
    <ul>
      <li>{{$value.nick}}</li>
      <li>


           <span class="noColor">
             {{each $value.starts}}
             <img src="{{$value}}" >

              {{/each}}
             <!--<em>2018-03-20   </em>-->
             <em>{{$value.createtime |  dateFormat 'YYYY-MM-DD'}}</em>
           </span>
      </li>
      <li class="commentdetail">{{$value.comment}}</li>
      <li class="commentposition"><img src="./images/position.jpg">{{$value.city}} {{$value.area}}</li>
    </ul>
  </div>
  {{/each}}
</script>
<!--翻页跳过-->
<script type="text/html">
  <div class="fenye2">
    <a href="javascript:;" class="pageup on"> < 上一页</a>
    <div class="showPage">
      <a href="javascript:;" class="num acv">1</a>
      <a href="javascript:;" class="num">2</a>
      <a href="javascript:;" class="num">3</a>
      <a href="javascript:;" class="num">4</a>
      <a href="javascript:;" class="num">5</a>
      <a href="javascript:;" class="num">6</a>
      <a href="javascript:;" class="num">7</a>
      <a href="javascript:;" class="num">8</a>
      <a href="javascript:;" class="num">9</a>
      ...
    </div>
    <a href="javascript:;" class="pagedown ">下一页 ></a>
  </div>
</script>
</body>
</html>